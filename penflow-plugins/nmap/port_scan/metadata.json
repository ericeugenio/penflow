{
  "name": "nmap.port_scan",
  "displayName": "Scan target ports",
  "description": "Performs a scan of the specified ports to a given target",
  "summary": "Scan ports of target $properties.host and store them in $outputs.discoveredPorts",
  "icon": "https://nmap.org/images/sitelogo-nmap.svg",
  "type": "runnable",
  "requiredProperties": ["host", "ports"],
  "principalProperties": ["host", "ports"],
  "properties": {
    "host": {
      "order": 0,
      "displayName": "Host",
      "description": "Host address. Rn only support for IPv4 address",
      "type": "string"
    },
    "ports": {
      "order": 1,
      "displayName": "Port ranges",
      "description": "Port ranges to scan separated by a hyphen (e.g. 1-1024), multiple ranges are separated by a comma (e.g. 20-22,53,80). If not specified by default it scans the most common 1000 ports.",
      "type": "string"
    },
    "scanTechnique": {
      "order": 2,
      "displayName": "Scan technique",
      "description": "Scanning method used, by default TCP Connect Scan",
      "type": "enum",
      "options": [
        "TCP SYN Scan",
        "TCP ACK Scan",
        "TCP Connect Scan"
      ],
      "default": "TCP Connect Scan"
    },
    "osDetection": {
      "order": 3,
      "displayName": "OS detection",
      "description": "Whether to collect or not information about the host operating system.",
      "type": "boolean",
      "default": false
    }
  },
  "outputs": {
    "address": {
      "displayName": "Host address",
      "description": "IPv4 address of the host.",
      "type": "string"
    },
    "discoveredPorts": {
      "displayName": "Discovered ports",
      "description": "List of discovered ports.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "protocol": {
            "description": "Protocol used by the port.",
            "type": "string"
          },
          "port": {
            "description": "Port number.",
            "type": "number"
          },
          "state": {
            "description": "State of the port (e.g. open, filtered).",
            "type": "string"
          },
          "service": {
            "description": "Name of the service running in the port.",
            "type": "string"
          }
        }
      }
    },
    "os": {
      "displayName": "Operating System",
      "description": "OS running on host.",
      "type": "string"
    }
  }
}